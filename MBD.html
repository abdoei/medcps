<!DOCTYPE html>
<html lang="en">
<title>Medical Cyber-Physical Systems at Penn</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="assets/css/bootstrap/css/bootstrap.css">
<link rel="stylesheet" href="assets/css/style.css">
<link rel="stylesheet" href="assets/css/header.css">
<link rel="stylesheet" href="assets/css/font-awesome/css/font-awesome.css">

<body>

<!--=== Header ===-->    
<div class="header">
    <div class="navbar navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="index.html"><img id="logo-header" src="assets/img/logo.png" alt="Logo"></a>
            </div>

            <div>
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown active"><a href="index.html">Home</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-delay="0" data-close-others="false">Research<i class="icon-angle-down"></i></a>
                        <ul class="dropdown-menu">
                            <li><a href="patient_specific_heart_modeling.html">Patient-specific Heart Modeling</a></li>
                            <li><a href="fiber_effect.html">Myocardial Fiber Effects on Arrhythmia Activation Patterns</a></li>
                            <li><a href="VHM.html">Heart Modeling for Closed-loop Evaluation of Pacemakers</a></li>
                            <li><a href="verification.html">Pacemaker Software Verification</a></li>
                            <li><a href="MBD.html">Model-based Design for Medical Device Software</a></li>
                            <li><a href="MBCT.html">Computer-Aided Clinical Trials</a></li>
                            <li><a href="physiology.html">Physiological Control Systems</a></li>
                        </ul>
                    </li>
                    <li class="dropdown"><a href="publications.html">Publications</a></li>
                    <li class="dropdown"><a href="people.html">People</a></li>
                    <li class="dropdown"><a href="awards.html">Awards</a></li>
                    <li class="dropdown"><a href="downloads.html">Downloads</a></li>
                    </li><li class="dropdown"><a href="faq.html">FAQ</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="breadcrumbs margin-bottom-40">
    <div class="container">
        <h1 class="pull-left">Model-based Design Framework for Pacemaker Software</h1>
    </div>
</div>

<!--=== Content Part ===-->
<div class="container">		
	<div class="row">            
        <div class="col-md-9">
            <div class="headline"><h2>Problem Statement</h2></div>
            <div class="panel-group acc-v1 margin-bottom-40" id="accordion">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                                <strong>Motivation</strong></a>
                        </h3>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse in">
                        <div class="panel-body">
                            <img src="assets/img/main/pacemaker.png" alt="" width="100" class="pull-right lft-img-margin img-width-100">
                            <ul class="list-unstyled">
                              <li>
                                <h4><i class="icon-thumbs-down color-red"></i>Over <strong class="color-red">600,000</strong> cardiac medical devices recalled from 1990-2000.</h4>
                              </li>
                              <li><h4><i class="icon-thumbs-down color-red"></i><strong class="color-red">40%</strong> of recent recalls were due to <strong class="color-red">software issues </strong></h4></li>
                              <!--<li><h4><i class="icon-hand-right color-green"></i>It is essential to guarantee the <strong>safety</strong> and <strong>efficacy</strong> of the device software</h4></li>-->
                             
                          </ul>
                         <blockquote>
                        <h3>It is essential to guarantee the <strong class="color-green">safety</strong> and <strong class="color-green">efficacy</strong> of the device software</h3>
                        
                    </blockquote>   
                      </div>
                    </div>
                </div>
                 <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseFour">
                                <strong>Cyber Physical Challenges for Medical Devices Evaluation</strong>
                            </a>
                        </h4>
                    </div>
                    <div id="collapseFour" class="panel-collapse collapse">
                        <div class="panel-body">
                        <img src="assets/img/challenges.png" alt="" width="300" class="pull-right lft-img-margin img-width-300">
                            <ul class="list-unstyled">
                              <li>
                                <i class="icon-hand-right color-red"></i> <strong>The Pacemaker (and other medical devices):</strong>
                                <ul>
                                <li> Autonomous device with minimum human interaction, therefore has to be able to operate under all possible conditions.
</li>
<li>Limited diagnostic capability, inevitably leading to false-positives and false-negatives, and limited therapy capability, being able to treat the disease to a certain degree.  
</li>
<li>It is the safety of the patient we care about. Therefore the safety of the pacemaker must be evaluated in closed-loop within its environment
</li>
                               </ul>
                              <li>
                                <i class="icon-hand-right color-red"></i> <strong>The physical plant:</strong>
                                <ul>
                                <li> Not only the heart, but also the rest of the body

</li>
<li>Different dynamics even in a single patient

</li>
<li>Each condition has its own corresponding optimal condition 

</li>
                               </ul>
                              </li>
                          </ul>
                        </div>
                    </div>
                </div>
<div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapse2">
                                <strong>FDA Pre-market Certification and the State-of-the-art Evaluations</strong>
                            </a>
                        </h4>
                    </div>
                    <div id="collapse2" class="panel-collapse collapse">
                        <div class="panel-body">
                        <img src="assets/img/main/fda-logo.jpg" alt="" width="150" class="pull-right lft-img-margin img-width-150">
                           Currently the US FDA requires the device manufacturers to submit proofs for:
                            <ul class="list-unstyled">
                              <li>
                                <p><i class="icon-hand-right color-red"></i><strong>The final product:</strong> The safety and efficacy of the device itself</p>
                              </li>
                              <li>
                                <p><i class="icon-hand-right color-red"></i><strong>The development process: </strong>Rigorous design process which provides <strong class="color-red">traceability</strong> of requirements</p>
                              </li>
                              
                          </ul> 
                          Currently the device manufacturers use <strong class="color-red">open-loop testing</strong> to evaluate the safety of the device and there is <strong class="color-red">no formal methodologies</strong> during the design process. 
                        </div>
                    </div>
              </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
                                <strong>The problem of traditional software development</strong>
                            </a>
                        </h4>
                        
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse">
                        <div class="panel-body">
                            <img src="assets/img/development.png" alt="" width="250" class="pull-right lft-img-margin img-width-250">
                                                       
                            <p>During the past decades, pacemakers implanted into patients have recorded episodes of closed-loop interactions (Senario 1 ~ Senario N) between the heart in different conditions (Heart 1 ~ Heart N) and the pacemaker . The recordings are either appropriate pacemaker behavior in response to heart condition which all new pacemakers should also have, or inappropriate pacemaker behavior so that the new pacemakers should avoid. In order to evaluate the performance of a new pacemaker design (Pacemaker X), the inputs from the hearts in those recordings, representing different heart conditions, are fed into the new pacemaker and the outputs of the new pacemaker are compared to the recorded outputs in those senarios. </p>
                            
                            <p><strong class="color-red">The problem of open-loop testing</strong> is that the input signals from heart do not capture the heart physiology and will not change to different pacemaker outputs. Given a closed-loop interaction between Heart i and Pacemaker i and feed its heart input signals to Pacemaker X will not capture the closed-loop behavior of Pacemaker X under heart condition i. In order to evaluate pacemaker executions under different heart conditions, especially the executions with adquate depth, there has to be a model of the heart which can capture the physiological conditions of the heart and respond to pacemaker outputs.</p>
                            
                      </div>
                    </div>
                </div>

                
                 <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
                                <strong>Maintain Traceability of requirements</strong>
                            </a>
                        </h4>
                    </div>
                    <div id="collapseThree" class="panel-collapse collapse">
                        <div class="panel-body">
                        <img src="assets/img/upp2sf.png" alt="" width="400" class="pull-right lft-img-margin img-width-400">
                            <p>We developed a model-based design framework for pacemaker software. A heart model structure was designed based on the electrophysiology of the heart. At each development stage a version of the heart model is available to interact with the pacemaker model/implementation.</p>
                                              <ul class="list-unstyled">
                                <li><i class="icon-ok color-green"></i> At verification level we have a set of <strong class="color-green">non-deterministic</strong> version of our heart models with different abstraction level which covers all possible inputs to the pacemaker under different heart conditions. Depending on the condition of the safety/efficacy properties, we choose heart model with appropirate structure and abstraction level to cover the inputs to the pacemaker under heart conditions specified in the properties. </li>
                                <li><i class="icon-ok color-green"></i>
                                At Simulation level the non-determinism of our heart model are resolved by linear interpolation of the parameter ranges. The <strong class="color-green">deterministic</strong> version of our heart model responds to pacemaker pacing signals the same way as a real heart. 
                                </li>
                                <li><i class="icon-ok color-green"></i>
                                The deterministic heart model can be translated into HDL code by Mathworks HDL coder and implemented on a FPGA chip. With appropriate analog interface, the platform can be used for closed-loop testing of pacemaker implementations.
                                </li>
                                </ul>      
                      </div>
                    </div>
                </div>
                 
                <div class="headline"><h2>Heart Modeling</h2></div>
               
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#test" href="#collapse4">
                                <strong>Timed automata vs. other formalisms</strong>
                            </a>
                        </h4>
                    </div>
                    
                    <div id="collapse4" class="panel-collapse collapse">
                        <div class="panel-body">
                        
                            <p> We chose Timed Automata as the formalism for the heart model for several reasons:</p>
                             <ul class="list-unstyled">
                             <li>
                                <p><i class="icon-hand-right color-green"></i>Nondeterminism which enables model abstraction which increase coverage.
                                </p>
                               </li>
                                <li><i class="icon-hand-right color-green"></i>The reachability problem for timed automata is decidable, allowing us to explore the whole state space of the heart and pacemaker. 
                                </li>
                                <li><i class="icon-hand-right color-green"></i>Most timing behaviors of the heart can be captured by timed automata
                                </li>
                          </ul>
                     
                                              
                      </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#test" href="#collapse3">
                                <strong>The proper level of abstraction: Coverage vs. Expressiveness</strong>
                            </a>
                        </h4>
                    </div>
                    
                    <div id="collapse3" class="panel-collapse in">
                        <div class="panel-body">
                        <img src="assets/img/main/coverage.png" alt="" width="300" class="pull-right lft-img-margin img-width-300">
                            <p>In order to be used in different stages during the development process, the <strong class="color-green">structure</strong> and <strong class="color-green">parameters</strong> of our heart model need to be adjusted to balance between <strong class="color-green">Coverage vs. Expressiveness</strong>.</p> 
                            <p>Intuitively, the more complex the model is, there is more constraints on its behaviors, thus limiting its coverage. On the other hand, the added complexity allows us to capture more detailed mechanisms of the heart, allowing us to precisely model a specific heart condition. So instead of developing a single heart model, we developed a series of heart models at different abstraction levels. With <strong class="color-green">Counter-Example-Guided Abstraction & Refinement (CEGAR)</strong> framework, we are able to choose the proper level of heart model abstraction during verification thus balancing coverage and expressiveness.</p>
                                              
                      </div>
                    </div>
                </div>
                <div class="headline"><h3><a id="abstraction"></a>Heart Abstractions</h3></div>
                <div class="tab-v1">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#ab0" data-toggle="tab">Abstraction 0</a></li>
                    <li><a href="#ab1" data-toggle="tab">Abstraction 1</a></li>
                    <li><a href="#ab2" data-toggle="tab">Abstraction 2</a></li>
                    <li><a href="#ab3" data-toggle="tab">Abstraction 3</a></li>
                    <li><a href="#ab4" data-toggle="tab">Abstraction 4</a></li>
                </ul>                
                <div class="tab-content">
                    <div class="tab-pane active" id="ab0">
                        <div class="row">
                           
                            <div class="col-md-12">
                                <h4>Behaviorial Model of Heart Tissue</h4>
                              <img src="assets/img/N0.png" alt="" width="435" class="pull-right lft-img-margin img-width-430">
                            <p>We first start with modeling the electrical behaviors of a heart tissue. A whole model of the heart consists of node automata (N0) which models the timed transitions among different time periods with different behaviors after the tissue is depolarized. The heart can then be modeled as: <img src="assets/img/equations/H0.png"> where N can be arbitarily large.</p>       
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane" id="ab1">
                                       
                        <h4>Abstract conduction delay with paths</h4>
                         <p><img src="assets/img/N1.png" alt="" width="400" class="pull-right lft-img-margin img-width-400"><img src="assets/img/equations/H0.5.png"></p>
                    </div>
                    <div class="tab-pane" id="ab2">
                        <h4>Heading Sample 3</h4>
                        <p><img src="assets/img/N2.png" alt="" width="400" class="pull-right lft-img-margin img-width-400"><strong>Vivamus imperdiet condimentum diam, eget placerat felis consectetur id.</strong> Donec eget orci metus, Vivamus imperdiet condimentum diam, eget placerat felis consectetur id. Donec eget orci metus, ac adipiscing nunc. Pellentesque fermentum, ante ac interdum ullamcorper. Donec eget orci metus, ac adipiscing nunc. Pellentesque fermentum, consectetur id. Donec eget orci metus, ac adipiscing nunc. <strong>Pellentesque fermentum</strong>, ante ac interdum ullamcorper. Donec eget orci metus, ac adipiscing nunc. Pellentesque fermentum, ante ac interdum ullamcorper.</p>
                    </div>
                    <div class="tab-pane" id="ab3">
                        <h4>Heading Sample 4</h4>
                        <p><img src="assets/img/N3.png" alt="" width="400" class="pull-right lft-img-margin img-width-400"> Vivamus imperdiet condimentum diam, eget placerat felis consectetur id. Donec eget orci metus, Vivamus imperdiet condimentum diam, eget placerat felis consectetur id. Donec eget orci metus, ac adipiscing nunc. Pellentesque fermentum, ante ac interdum ullamcorper. Donec eget orci metus, ac adipiscing nunc. Pellentesque fermentum, consectetur id. Donec eget orci metus, ac adipiscing nunc. <strong>Pellentesque fermentum</strong>, ante ac interdum ullamcorper. Donec eget orci metus, ac adipiscing nunc. Pellentesque fermentum, ante ac interdum ullamcorper.</p>
                    </div>
                    <div class="tab-pane" id="ab4">
                        <h4>Heading Sample 4</h4>
                        <p><img src="assets/img/N4.png" alt="" width="400" class="pull-right lft-img-margin img-width-400"> Vivamus imperdiet condimentum diam, eget placerat felis consectetur id. Donec eget orci metus, Vivamus imperdiet condimentum diam, eget placerat felis consectetur id. Donec eget orci metus, ac adipiscing nunc. Pellentesque fermentum, ante ac interdum ullamcorper. Donec eget orci metus, ac adipiscing nunc. Pellentesque fermentum, consectetur id. Donec eget orci metus, ac adipiscing nunc. <strong>Pellentesque fermentum</strong>, ante ac interdum ullamcorper. Donec eget orci metus, ac adipiscing nunc. Pellentesque fermentum, ante ac interdum ullamcorper.</p>
                    </div>
                </div>
            </div>
        </div>
        
               
<div class="headline"><h3>Heart Model Simulation & Implementation</h3></div>
<img src="assets/img/HOC.png" alt="" width="400" class="pull-right lft-img-margin img-width-400">
		</div><!--/col-md-9-->
        
		<div class="col-md-3">
        </div><!--/col-md-3-->            		
    </div><!--/row-->
</div><!--/container-->		
<!--=== End Content Part ===-->

<!--=== Footer ===-->
<div class="footer">
	<div class="container">
		<div class="row">
			<div class="col-md-4 md-margin-bottom-40">
		        <div class="headline"><h2>About</h2></div>	
				<p class="margin-bottom-25 md-margin-bottom-40">The Medical Cyber-Physical System research in Penn is part of the <a href="http://precise.seas.upenn.edu/" target="_blank">PRECISE research group</a>.</p>	
			</div>
			
			<div class="col-md-4">
		        <div class="headline"><h2>Contact</h2></div>	
                <address class="md-margin-bottom-40">
                    University of Pennsylvania<br />
                    Levine building room 279<br />
					3330 Walnut Street<br />
					Philadelphia, PA, 19104<br />
					Email: rahulm@seas.upenn.edu
                </address>
		  </div>
		</div>
	</div>
</div>

<!--=== Copyright ===-->
<div class="copyright">
	<div class="container">
		<div class="row">
			<div class="col-md-6">						
	            <p class="copyright-space">
                <span id="year"></span> &copy; MedCPS. ALL Rights Reserved.</p>
			</div>
			<div class="col-md-6">	
				<a href="http://precise.seas.upenn.edu/">
                    <img src="assets/img/precise.png" alt="" width="255" height="65" class="pull-right" id="logo-footer" />
                </a>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript" src="assets/css/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="assets/css/hover-dropdown.min.js"></script> 
<script>document.getElementById("year").innerHTML = new Date().getFullYear();</script>

</body>
</html>	